(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(a){if(a.ep)return;a.ep=!0;const s=r(a);fetch(a.href,s)}})();const g={flower:{displayName:"Flower of Life"},plume:{displayName:"Plume of Death"},sands:{displayName:"Sands of Eon"},goblet:{displayName:"Goblet of Eonothem"},circlet:{displayName:"Circlet of Logos"}},T={flower:{HP:1},plume:{ATK:1},sands:{"HP%":8,"ATK%":8,"DEF%":8,EM:3,ER:3},goblet:{"HP%":77,"ATK%":77,"DEF%":76,"PYRO%":20,"ELECTRO%":20,"CRYO%":20,"HYDRO%":20,"DENDRO%":20,"ANEMO%":20,"GEO%":20,"PHYSICAL%":20,EM:10},circlet:{"HP%":11,"ATK%":11,"DEF%":11,CR:5,CD:5,HB:5,EM:2}},K={HP:6,ATK:6,DEF:6,"HP%":4,"ATK%":4,"DEF%":4,EM:4,ER:4,CR:3,CD:3},P={HP:[209.13,239,268.88,298.75],ATK:[13.62,15.56,17.51,19.45],DEF:[16.2,18.52,20.83,23.15],"HP%":[4.08,4.66,5.25,5.83],"ATK%":[4.08,4.66,5.25,5.83],"DEF%":[5.1,5.83,6.56,7.29],EM:[16.32,18.65,20.98,23.31],ER:[4.53,5.18,5.83,6.48],CR:[2.72,3.11,3.5,3.89],CD:[5.44,6.22,6.99,7.77]},R={HP:{displayName:"HP",hasPercentage:!1},ATK:{displayName:"ATK",hasPercentage:!1},DEF:{displayName:"DEF",hasPercentage:!1},"HP%":{displayName:"HP",hasPercentage:!0},"ATK%":{displayName:"ATK",hasPercentage:!0},"DEF%":{displayName:"DEF",hasPercentage:!0},EM:{displayName:"Elemental Mastery",hasPercentage:!1},ER:{displayName:"Energy Recharge",hasPercentage:!0},CR:{displayName:"CRIT Rate",hasPercentage:!0},CD:{displayName:"CRIT DMG",hasPercentage:!0}},N={HP:{displayName:"HP",hasPercentage:!1},ATK:{displayName:"ATK",hasPercentage:!1},DEF:{displayName:"DEF",hasPercentage:!1},"HP%":{displayName:"HP",hasPercentage:!0},"ATK%":{displayName:"ATK",hasPercentage:!0},"DEF%":{displayName:"DEF",hasPercentage:!0},EM:{displayName:"Elemental Mastery",hasPercentage:!1},ER:{displayName:"Energy Recharge",hasPercentage:!0},CR:{displayName:"CRIT Rate",hasPercentage:!0},CD:{displayName:"CRIT DMG",hasPercentage:!0},HB:{displayName:"Healing Bonus",hasPercentage:!0},"PYRO%":{displayName:"Pyro DMG Bonus",hasPercentage:!0},"ELECTRO%":{displayName:"Electro DMG Bonus",hasPercentage:!0},"CRYO%":{displayName:"Cryo DMG Bonus",hasPercentage:!0},"HYDRO%":{displayName:"Hydro DMG Bonus",hasPercentage:!0},"DENDRO%":{displayName:"Dendro DMG Bonus",hasPercentage:!0},"ANEMO%":{displayName:"Anemo DMG Bonus",hasPercentage:!0},"GEO%":{displayName:"Geo DMG Bonus",hasPercentage:!0},"PHYSICAL%":{displayName:"Physical DMG Bonus",hasPercentage:!0}},O={HP:[717,920,1123,1326,1530,1733,1936,2139,2342,2545,2749,2952,3155,3358,3561,3764,3967,4171,4374,4577,4780],"HP%":[7,9,11,12.9,14.9,16.9,18.9,20.9,22.8,24.8,26.8,28.8,30.8,32.8,34.7,36.7,38.7,40.7,42.7,44.6,46.6],ATK:[47,60,73,86,100,113,126,139,152,166,179,192,205,219,232,245,258,272,285,298,311],"ATK%":[7,9,11,12.9,14.9,16.9,18.9,20.9,22.8,24.8,26.8,28.8,30.8,32.8,34.7,36.7,38.7,40.7,42.7,44.6,46.6],"DEF%":[8.7,11.2,13.7,16.2,18.6,21.1,23.6,26.1,28.6,31,33.5,36,38.5,40.9,43.4,45.9,48.4,50.8,53.3,55.8,58.3],EM:[28,36,44,52,60,68,76,84,91,99,107,115,123,131,139,147,155,163,171,179,187],ER:[7.8,10,12.2,14.4,16.6,18.8,21,23.2,25.4,27.6,29.8,32,34.2,36.4,38.6,40.8,43,45.2,47.4,49.6,51.8],CR:[4.7,6,7.4,8.7,10,11.4,12.7,14,15.4,16.7,18,19.3,20.7,22,23.3,24.7,26,27.3,28.7,30,31.1],CD:[9.3,11.9,14.6,17.2,19.9,22.5,25.2,27.8,30.5,33.1,35.8,38.4,41.1,43.7,46.3,49,51.6,54.3,56.9,59.6,62.2],HB:[5.4,6.9,8.4,10,11.5,13,14.5,16.1,17.6,19.1,20.6,22.2,23.7,25.2,26.7,28.3,29.8,31.3,32.8,34.4,35.9],"PYRO%":[7,9,11,12.9,14.9,16.9,18.9,20.9,22.8,24.8,26.8,28.8,30.8,32.8,34.7,36.7,38.7,40.7,42.7,44.6,46.6],"ELECTRO%":[7,9,11,12.9,14.9,16.9,18.9,20.9,22.8,24.8,26.8,28.8,30.8,32.8,34.7,36.7,38.7,40.7,42.7,44.6,46.6],"CRYO%":[7,9,11,12.9,14.9,16.9,18.9,20.9,22.8,24.8,26.8,28.8,30.8,32.8,34.7,36.7,38.7,40.7,42.7,44.6,46.6],"HYDRO%":[7,9,11,12.9,14.9,16.9,18.9,20.9,22.8,24.8,26.8,28.8,30.8,32.8,34.7,36.7,38.7,40.7,42.7,44.6,46.6],"DENDRO%":[7,9,11,12.9,14.9,16.9,18.9,20.9,22.8,24.8,26.8,28.8,30.8,32.8,34.7,36.7,38.7,40.7,42.7,44.6,46.6],"ANEMO%":[7,9,11,12.9,14.9,16.9,18.9,20.9,22.8,24.8,26.8,28.8,30.8,32.8,34.7,36.7,38.7,40.7,42.7,44.6,46.6],"GEO%":[7,9,11,12.9,14.9,16.9,18.9,20.9,22.8,24.8,26.8,28.8,30.8,32.8,34.7,36.7,38.7,40.7,42.7,44.6,46.6],"PHYSICAL%":[8.7,11.2,13.7,16.2,16.2,21.1,23.6,26.1,28.6,31,33.5,36,38.5,40.9,43.4,45.9,48.4,50.8,53.3,55.8,58.3]},H={domain:1/5,other:1/3};class E{setKey;slotKey;level;mainStatKey;substats;source;isFourLinerStart;constructor(t,r=null,n=0,a=null,s=[],o="domain"){this.setKey=t,this.source=o,this.level=n,this.isFourLinerStart=this.determineIfFourLiner(o),this.slotKey=r??this.initializeSlot(),this.mainStatKey=a??this.initializeMainStat(),this.substats=s.length?s:this.initializeSubstats()}determineIfFourLiner(t){return Math.random()<H[t]}initializeSlot(){const t=Object.keys(g);return t[Math.floor(Math.random()*t.length)]}initializeMainStat(){const t=T[this.slotKey],r=Object.entries(t),n=r.reduce((o,[,c])=>o+c,0),a=Math.random()*n;let s=0;for(const[o,c]of r)if(s+=c,a<=s)return o;return r[0][0]}initializeSubstats(){const t=[],r={...K};delete r[this.mainStatKey];for(let n=0;n<4;n++){const a=Object.values(r).reduce((c,m)=>c+m,0),s=Math.random()*a;let o=0;for(const[c,m]of Object.entries(r))if(o+=m,s<=o){const u=Math.floor(Math.random()*4);t.push({statKey:c,rolls:[{tier:u,value:P[c][u]}],isActive:n<3||this.isFourLinerStart}),delete r[c];break}}return t}rerollSubstats(){this.level=0,this.substats[3].isActive=!!this.isFourLinerStart,this.substats.forEach(t=>{t.rolls=[t.rolls[0]]}),this.levelUp(20)}levelUp(t=1){const r=Math.min(this.level+t,20);for(let n=this.level+1;n<=r;n++)if(n%4===0)if(!this.substats[3].isActive)this.substats[3].isActive=!0;else{const a=this.substats[Math.floor(Math.random()*4)],s=Math.floor(Math.random()*4);a.rolls.push({tier:s,value:P[a.statKey][s]})}this.level=r}getDisplayData(t){const r=t[this.setKey];return{artifactName:r.slotNames[this.slotKey],slotName:g[this.slotKey].displayName,mainStatKey:this.mainStatKey,level:this.level,setName:r.displayName,substats:this.substats}}}async function L(){const e=await fetch("./data/artifact_sets.json");if(!e.ok)throw new Error(`Failed to load artifact sets: ${e.statusText}`);return await e.json()}function F(e,t){return+(Math.round(+(e+"e+"+t))+"e-"+t)}function i(e){const t=document.getElementById(e);if(!t)throw new Error(`Element with ID "${e}" not found`);return t}function w(e){let n=6.91;for(e.style.fontSize=`${n}cqw`,e.style.textWrap="nowrap";e.scrollWidth>e.clientWidth&&n>4.85;)n=Math.max(4.85,n-.01),e.style.fontSize=`${n}cqw`;e.scrollWidth>e.clientWidth?e.style.textWrap="wrap":e.style.textWrap="nowrap"}function I(e,t){return t?new Intl.NumberFormat("en-US",{minimumFractionDigits:1,maximumFractionDigits:1}).format(e).toString():new Intl.NumberFormat("en-US",{maximumFractionDigits:0}).format(e).toString()}let d=null,l=null,y=0;const S=i("set-selector"),x=i("generate-btn"),B=i("reroll-count");G();async function G(){d=await L(),W(),A(!1),Y(),i("reroll").disabled=!0,i("artifact-card").style.visibility="hidden"}function W(){d&&(Object.entries(d).forEach(([e,t])=>{S.add(new Option(t.displayName,e))}),x.addEventListener("click",_))}function _(){if(!d)return;const e=S.value;e&&(y=0,l=$(e),h(l),A(!0),i("artifact-card").style.visibility="visible")}function $(e){if(!i("double-crit-checkbox").checked)return new E(e);for(;;){const r=new E(e),n=r.substats.some(s=>s.statKey==="CR"),a=r.substats.some(s=>s.statKey==="CD");if(n&&a)return r}}function h(e){if(!d)return;const t=e.getDisplayData(d);i("slot-name").textContent=t.slotName,i("main-stat-name").textContent=N[t.mainStatKey].displayName,i("level").textContent=`+${t.level}`,i("set-name").textContent=`${t.setName}:`,e.substats.forEach((c,m)=>{const u=i(`substat-${m+1}`),D=c.rolls.reduce((C,b)=>C+b.value,0),f=R[c.statKey],v=F(D,Number(f.hasPercentage)).toFixed(Number(f.hasPercentage)),M=f.hasPercentage?"%":"";let p=`${f.displayName}+${v}${M}`;c.isActive?u.style.color="":(p+="  (unactivated)",u.style.color="gray"),u.textContent=`Â·${p}`}),i("artifact-img").src=`data/icons/${e.setKey}/${e.slotKey}.webp`;const r=i("artifact-name").firstChild;r.textContent=t.artifactName,w(r);const n=O[t.mainStatKey][e.level],a=N[t.mainStatKey].hasPercentage,s=a?"%":"",o=I(n,a);i("main-stat-value").textContent=`${o}${s}`,B.textContent=`Rerolls: ${y}`,U(e.level)}function U(e){i("reroll").disabled=e!==20}function A(e){i("level-up-1").disabled=!e,i("level-up-tier").disabled=!e,i("level-up-max").disabled=!e}function Y(){i("level-up-1").addEventListener("click",()=>{l&&(l.levelUp(1),h(l))}),i("level-up-tier").addEventListener("click",()=>{if(!l)return;const e=Math.min(Math.ceil((l.level+1)/4)*4,20);l.levelUp(e-l.level),h(l)}),i("level-up-max").addEventListener("click",()=>{l&&(l.levelUp(20-l.level),h(l))}),i("reroll").addEventListener("click",()=>{l&&(y+=1,l.rerollSubstats(),h(l))})}
