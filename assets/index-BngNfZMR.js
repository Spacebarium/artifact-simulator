(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const n of l.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&i(n)}).observe(document,{childList:!0,subtree:!0});function a(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerPolicy&&(l.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?l.credentials="include":s.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function i(s){if(s.ep)return;s.ep=!0;const l=a(s);fetch(s.href,l)}})();const h={flower:{displayName:"Flower of Life"},plume:{displayName:"Plume of Death"},sands:{displayName:"Sands of Eon"},goblet:{displayName:"Goblet of Eonothem"},circlet:{displayName:"Circlet of Logos"}},D={flower:{HP:1},plume:{ATK:1},sands:{"HP%":8,"ATK%":8,"DEF%":8,EM:3,ER:3},goblet:{"HP%":77,"ATK%":77,"DEF%":76,"PYRO%":20,"ELECTRO%":20,"CRYO%":20,"HYDRO%":20,"DENDRO%":20,"ANEMO%":20,"GEO%":20,"PHYSICAL%":20,EM:10},circlet:{"HP%":11,"ATK%":11,"DEF%":11,CR:5,CD:5,HB:5,EM:2}},A={HP:6,ATK:6,DEF:6,"HP%":4,"ATK%":4,"DEF%":4,EM:4,ER:4,CR:3,CD:3},p={HP:[209.13,239,268.88,298.75],ATK:[13.62,15.56,17.51,19.45],DEF:[16.2,18.52,20.83,23.15],"HP%":[4.08,4.66,5.25,5.83],"ATK%":[4.08,4.66,5.25,5.83],"DEF%":[5.1,5.83,6.56,7.29],EM:[16.32,18.65,20.98,23.31],ER:[4.53,5.18,5.83,6.48],CR:[2.72,3.11,3.5,3.89],CD:[5.44,6.22,6.99,7.77]},v={HP:{displayName:"HP",hasPercentage:!1,decimalPlaces:0},ATK:{displayName:"ATK",hasPercentage:!1,decimalPlaces:0},DEF:{displayName:"DEF",hasPercentage:!1,decimalPlaces:0},"HP%":{displayName:"HP",hasPercentage:!0,decimalPlaces:1},"ATK%":{displayName:"ATK",hasPercentage:!0,decimalPlaces:1},"DEF%":{displayName:"DEF",hasPercentage:!0,decimalPlaces:1},EM:{displayName:"Elemental Mastery",hasPercentage:!1,decimalPlaces:0},ER:{displayName:"Energy Recharge",hasPercentage:!0,decimalPlaces:1},CR:{displayName:"CRIT Rate",hasPercentage:!0,decimalPlaces:1},CD:{displayName:"CRIT DMG",hasPercentage:!0,decimalPlaces:1}},S={HP:{displayName:"HP"},ATK:{displayName:"ATK"},DEF:{displayName:"DEF"},"HP%":{displayName:"HP"},"ATK%":{displayName:"ATK"},"DEF%":{displayName:"DEF"},EM:{displayName:"Elemental Mastery"},ER:{displayName:"Energy Recharge"},CR:{displayName:"CRIT Rate"},CD:{displayName:"CRIT DMG"},HB:{displayName:"Healing Bonus"},"PYRO%":{displayName:"Pyro DMG Bonus"},"ELECTRO%":{displayName:"Electro DMG Bonus"},"CRYO%":{displayName:"Cryo DMG Bonus"},"HYDRO%":{displayName:"Hydro DMG Bonus"},"DENDRO%":{displayName:"Dendro DMG Bonus"},"ANEMO%":{displayName:"Anemo DMG Bonus"},"GEO%":{displayName:"Geo DMG Bonus"},"PHYSICAL%":{displayName:"Physical DMG Bonus"}},T={domain:1/5,other:1/3};class g{setKey;slotKey;level;mainStatKey;substats;source;constructor(e,a=null,i=0,s=null,l=[],n="domain"){this.setKey=e,this.slotKey=a??this.initializeSlot(),this.level=i,this.mainStatKey=s??this.initializeMainStat(),this.substats=l.length?l:this.initializeSubstats(n),this.source=n}initializeSlot(){const e=Object.keys(h);return e[Math.floor(Math.random()*e.length)]}initializeMainStat(){const e=D[this.slotKey],a=Object.entries(e),i=a.reduce((n,[,c])=>n+c,0),s=Math.random()*i;let l=0;for(const[n,c]of a)if(l+=c,s<=l)return n;return a[0][0]}initializeSubstats(e){const a=[],i={...A};delete i[this.mainStatKey];for(let s=0;s<4;s++){const l=Object.values(i).reduce((d,m)=>d+m,0),n=Math.random()*l;let c=0;for(const[d,m]of Object.entries(i))if(c+=m,n<=c){const f=Math.floor(Math.random()*4);a.push({statKey:d,rolls:[{tier:f,value:p[d][f]}],isActive:s<3||Math.random()<T[e]}),delete i[d];break}}return a}levelUp(e=1){const a=Math.min(this.level+e,20);for(let i=this.level+1;i<=a;i++)if(i%4===0)if(!this.substats[3].isActive)this.substats[3].isActive=!0;else{const s=this.substats[Math.floor(Math.random()*4)],l=Math.floor(Math.random()*4);s.rolls.push({tier:l,value:p[s.statKey][l]})}this.level=a}getDisplayData(e){const a=e[this.setKey];return{artifactName:a.slotNames[this.slotKey],slotName:h[this.slotKey].displayName,mainStatKey:this.mainStatKey,level:this.level,setName:a.displayName,substats:this.substats}}}const M="data/icons";async function K(){const t=await fetch("./data/artifact_sets.json");if(!t.ok)throw new Error(`Failed to load artifact sets: ${t.statusText}`);const e=await t.json(),a=[];for(const i of Object.keys(e)){const s=e[i].slotNames;for(const l of Object.keys(s)){const n=`${M}/${i}/${l}.webp`;a.push(n)}}return console.log(`Generated ${a.length} image paths for preloading.`),{sets:e,imagePaths:a}}function b(t,e){return+(Math.round(+(t+"e+"+e))+"e-"+e)}function o(t){const e=document.getElementById(t);if(!e)throw new Error(`Element with ID "${t}" not found`);return e}function C(t){return new Promise(e=>{const a=new Image;a.onload=()=>{e(a)},a.src=t})}async function R(t){const e=t.map(C);try{await Promise.all(e),console.log("All artifact icons preloaded and cached")}catch(a){console.error(`An error occurred while preloading images: ${a}`)}}let u=null,r=null;const N=o("set-selector"),O=o("generate-btn");H();async function H(){const t=await K();u=t.sets,await R(t.imagePaths),w(),P(!1),L()}function w(){u&&(Object.entries(u).forEach(([t,e])=>{N.add(new Option(e.displayName,t))}),O.addEventListener("click",I))}function I(){if(!u)return;const t=N.value;t&&(r=F(t),y(r),P(!0))}function F(t){if(!o("double-crit-only").checked)return new g(t);for(;;){const a=new g(t),i=a.substats.some(l=>l.statKey==="CR"),s=a.substats.some(l=>l.statKey==="CD");if(i&&s)return a}}function y(t){if(!u)return;const e=t.getDisplayData(u);o("artifact-name").textContent=e.artifactName,o("slot-name").textContent=e.slotName,o("main-stat-name").textContent=S[e.mainStatKey].displayName,o("level").textContent=`+${e.level}`,o("set-name").textContent=e.setName,t.substats.forEach((a,i)=>{const s=o(`substat-${i+1}`),l=a.rolls.reduce((f,E)=>f+E.value,0),n=v[a.statKey],c=b(l,n.decimalPlaces).toFixed(n.decimalPlaces),d=n.hasPercentage?"%":"";let m=`${n.displayName}+${c}${d}`;a.isActive?s.style.color="":(m+="  (unactivated)",s.style.color="gray"),s.textContent=`Â·${m}`}),o("artifact-img").src=`data/icons/${t.setKey}/${t.slotKey}.webp`}function P(t){o("level-up-1").disabled=!t,o("level-up-tier").disabled=!t,o("level-up-max").disabled=!t}function L(){o("level-up-1").addEventListener("click",()=>{r&&(r.levelUp(1),y(r))}),o("level-up-tier").addEventListener("click",()=>{if(!r)return;const t=Math.min(Math.ceil((r.level+1)/4)*4,20);r.levelUp(t-r.level),y(r)}),o("level-up-max").addEventListener("click",()=>{r&&(r.levelUp(20-r.level),y(r))})}
